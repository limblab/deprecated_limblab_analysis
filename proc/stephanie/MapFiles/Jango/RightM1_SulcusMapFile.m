curr_dir = mfilename('fullpath');
tmp = strfind(curr_dir,'\');
curr_dir = curr_dir(1:tmp(end));
filename = mfilename;
fileID = fopen([curr_dir filename '.cmp'],'wt');

%PCB_array = [pin_number row column cerebus]
PCB_array =[...
    2 6 0 1;...
    3 7 0 2;...
    4 8 0 3;...
    5 9 0 4;...
    6 6 1 5;...
    7 7 1 6;...
    8 8 1 7;...
    9 9 1 8;...
    10 5 2 9;...
    11 6 2 10;...
    12 7 2 11;...
    13 8 2 12;...
    14 9 2 13;...
    15 6 3 14;...
    16 7 3 15;...
    17 8 3 16;...
    18 1 0 17;...
    19 2 0 18;...
    20 3 0 19;...
    21 4 0 20;...
    22 1 1 21;...
    23 2 1 22;...
    24 3 1 23;...
    25 4 1 24;...
    26 0 2 25;...
    27 1 2 26;...
    28 2 2 27;...
    29 3 2 28;...
    30 4 2 29;...
    31 1 3 30;...
    32 2 3 31;...   
    33 3 3 32;...
    34 1 5 1;...
    35 2 5 2;...
    36 3 5 3;...
    37 4 5 4;...
    38 5 5 5;...
    39 6 5 6;...
    40 7 5 7;...
    41 8 5 8;...
    42 2 6 9;...
    43 3 6 10;...
    44 4 6 11;...
    45 5 6 12;...
    46 6 6 13;...
    47 7 6 14;...
    48 8 6 15;...
    49 9 6 16;...
    50 1 8 17;...
    51 2 8 18;...
    52 3 8 19;...
    53 4 8 20;...
    54 5 8 21;...
    55 6 8 22;...
    56 7 8 23;...
    57 8 8 24;...
    58 2 9 25;...
    59 3 9 26;...
    60 4 9 27;...
    61 5 9 28;...
    62 6 9 29;...
    63 7 9 30;...
    64 8 9 31;...   
    65 9 9 32];



fprintf(fileID,'%s \n','// Hand generated mapfile (Stephanie) \n');
fprintf(fileID,'%s%s%s\n','// code at 165.124.111.182/Jango_12a1/Right M1 sulcus map',filename,'.m');
fprintf(fileID,'%s \n','// Data is as follows ''c r b e l'' ');
fprintf(fileID,'%s \n','//   c - 0 based column from left to right ');
fprintf(fileID,'%s \n','//   r - 0 based row from bottom to top ');
fprintf(fileID,'%s \n','//   b - bank name - values can be A, B, C, or D ');
fprintf(fileID,'%s \n','//   e - 1 based electrode number within the bank - values can be 1-32 ');
fprintf(fileID,'%s \n','//   l - label used to rename channels in Central ');
fprintf(fileID,'%s \n','// ');
fprintf(fileID,'%s \n','// Comments begin with // ');
fprintf(fileID,'%s \n','// First non-comment line is the Mapfile description ');
fprintf(fileID,'%s \n','// ');
fprintf(fileID,'%s \n','Cerebus mapping for Jango''s Right M1 sulcus arrays (implanted Sept 10, 2013) ');

table_spec = '%u\t%u\tA\t%u\t%u\n';
% fprintf(table_spec,PCB_array(:,2),PCB_array(i,3),PCB_array(i,4),PCB_array(i,1));
fprintf(fileID,table_spec,PCB_array(:,[3 2 4 1])');
fclose(fileID); 


% disp('Start Excel data')
% disp(' ')
% figure;
% hold on
% for i=1:size(PCB_array,1)
%     text(PCB_array(i,4),PCB_array(i,3)-.3,[connectors{PCB_array(i,1)} '-' num2str(PCB_array(i,2))],...
%         'HorizontalAlignment','center','VerticalAlignment','middle')
%     plot(PCB_array(i,4),PCB_array(i,3),'ok','MarkerSize',15)
%     disp([num2str(PCB_array(i,5)) ',' connectors{PCB_array(i,1)} '-' num2str(PCB_array(i,2)) ',' char(64+PCB_array(i,4)) ',' num2str(PCB_array(i,3))]);
% end
% set(gca,'YDir','reverse','YTick',1:7,'XTick',1:9)
% axis equal
% xlim([0 10])
% ylim([0 8])

figure;
hold on
for i=1:size(PCB_array,1)
    text(PCB_array(i,3),PCB_array(i,2),num2str(PCB_array(i,1)),...
        'HorizontalAlignment','center','VerticalAlignment','middle')
    plot(PCB_array(i,3),PCB_array(i,2),'ok','MarkerSize',15)
%     disp([connectors{PCB_array(i,1)} '-' num2str(PCB_array(i,2)) ',' num2str(PCB_array(i,4)) ',' num2str(PCB_array(i,3))]);
end
% set(gca,'YDir','reverse','YTick',1:7,'XTick',1:9)
axis equal
xlim([-1 11])
ylim([-1 11])
